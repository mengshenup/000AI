# 🤖 000AI 自动化执行协议 (Autonomous Execution Protocol)

**⚠️ 最高优先级 (Prime Directives)**:
1.  **⚓ 协议锚定 (Protocol Anchoring)**: 每当开始一个新的复杂任务时，必须重新索引并锁定本协议的核心步骤，防止因上下文漂移而偏离规范。
2.  **🔄 自主闭环 (Autonomous Loop)**: **1. 🎯 需求实现** -> **2. 🛠️ 自主修复与验证** -> **3. 📝 注释专家** -> 交付。**严禁**在任务完成前请求用户确认。
3.  **🤐 零交互 (Zero Interaction)**: 所有命令必须静默执行 (`-y`, `--no-input`)。交互式脚本必须使用管道注入输入。
4.  **💾 抗遗忘 (Context Persistence)**: 无论对话多长，必须严格遵守“注释专家”规范。
5.  **💰 算力连续性策略 (Compute Continuity Strategy)**: 允许消耗 Token 进行深度推理。若输出内容过长，**必须主动分段输出**，防止物理截断导致逻辑中断。

---

## 🔄 核心工作流 (The 3-Step Loop)

### 1. 🎯 需求实现 (Implementation)
*   **行动**: 编写或修改代码以满足功能需求。
*   **标准**: **高评分紧凑代码 (High-Score Compact Code)**。
    *   **核心目标**: 追求代码在 **健壮性、性能、解耦度** 上的最高评分 (High Logic Score)。
    *   **必须**:
        *   **强类型约束**: 全面使用 Type Hints / Interfaces，确保类型安全。
        *   **极简命名 (Minimalist Naming)**: **强制**变量/函数名最多包含 **1 个下划线** (例如 `userid`, `data_list`, `process`). 牺牲 PEP8 规范以换取极致的 Token 效率和紧凑度。
        *   **原子化设计**: 单一职责原则，拒绝“上帝函数”。
    *   **禁止**: 任何形式的自然语言注释（包括 Docstrings）。
*   **目的**: 产出逻辑评分极高但体积极小的代码，为阶段 2 提供最佳底座。

### 2. 🛠️ 自主修复与验证 (Autonomous Repair & Verification)
*   **定义**: 这是**全自动修复 BUG 并验证成功的阶段**。必须在本地沙盒环境中，完全无需人工监督，直到代码真正成功运行。
*   **触发**: 代码编写完成后，**立即自动进入**。
*   **行动**: 在 `Debug/Trash/<YYYYMMDD>/` 创建临时测试脚本并**在终端实际运行**。
*   **核心规则 (The 5-Point Protocol)**:

    1.  **🛡️ 隔离沙盒执行 (Isolated Sandbox Execution)**:
        *   **真实性**: 严禁仅在“思维链”中模拟，必须看到真实的终端输出。
        *   **隔离性**: 所有临时文件必须存入 `Debug/Trash/<YYYYMMDD>/`，防止污染主工作区。

    2.  **零交互执行 (Zero-Interaction Execution)**:
        *   **强制静默**: 启动命令必须携带自动确认参数（如 `-y`, `--no-input`）。
        *   **管道注入**: 对于必须交互的脚本，**严禁**直接运行。必须使用管道（如 `echo "A" | python test.py`）或输入重定向文件来预先注入所有可能的输入。
        *   **违规即失败**: 任何导致终端出现“等待输入光标”的操作，均视为测试失败，需立即修正启动方式。

    3.  **🚫 阻塞检测 (Blocking Detection)**:
        *   **现象**: 程序启动后 **30 秒内** 无新输出，或输出包含 `[y/n]`, `Select`, `Enter`, `?`, `>` 等等待提示符。
        *   **判定**: 视为**交互阻塞**或**进程假死**。
        *   **处置**: **立即终止进程 (Kill)**。**绝不允许**傻等全局时限（15分钟）耗尽。

    4.  **故障自愈 (Self-Healing)**:
        *   **分析-修复-重启**: 针对报错或阻塞原因，**修改代码逻辑**或**调整启动命令**。
        *   **🏛️ 架构完整性 (Architectural Integrity)**: 修复 BUG 时，**严禁**为了追求速度而使用“脏修补” (Dirty Hacks)。必须维持阶段 1 的高评分逻辑，确保**最终交付的代码**在评分上不降级。
        *   **Token 节约**: 此阶段**严禁**添加装饰性注释，仅保留调试必要的打印信息，以节省 Token 并加快迭代。

    5.  **退出机制 (Exit Strategy)**:
        *   **全局时限**: **15 分钟**。这是为了防止无限循环的硬性熔断。
        *   **成功标准**: 代码无报错、无阻塞、且**输出符合预期结果**。
        *   **终止条件**: 达成成功标准，或时间耗尽，或连续 5 次卡在同一无法解决的死锁。

### 3. 📝 注释专家 (The Comment Expert)
*   **触发**: 仅在阶段 2 **验证成功后**执行。
*   **核心任务**: **逆向工程与文档注入 (Reverse Engineering & Documentation Injection)**。
    *   **第一步 (理解)**: 深度阅读阶段 2 验证通过后的**最终代码**，理解其经过修复后的业务逻辑和设计意图。
    *   **第二步 (注入)**: 基于对最终代码的理解，注入“五段式备注”和“逐行 Emoji 注释”，**严禁**修改任何代码逻辑。
    *   **质量保障**: 注释必须解释“Why” (设计意图) 而非简单的翻译代码。
*   **分块策略 (Chunking Strategy)**:
    *   若文件超过 50 行，**严禁**一次性全量输出。
    *   **必须**分块处理（例如每次处理 20-30 行），使用 `replace_string_in_file` 逐步应用注释。
    *   防止因输出过长导致模型“偷懒”或被物理截断。

#### 📜 注释规范 (Strict Standards)

**A. 文件头 (File Header)**
*   **位置**: 文件最顶部。
*   **格式**:
    ```text
    /* ==========================================================================
       📃 文件功能 : [写全]
       ⚡ 逻辑摘要 : [核心算法/思路]
       💡 易懂解释 : [高中生能懂，正面可爱语气，不使用比喻]
       🔋 扩展备注 : [未来扩展建议]
       🧱 踩坑记录 :
          [YYYY-MM-DD] [坑名]: [原因] -> [修复方案] (Line XX)
       ========================================================================== */
    ```

**B. 五段式备注 (The 5-Part Block)**
*   **适用**: 函数、类、模块、HTML容器。
*   **位置**: 定义行的下一行（内部）。
*   **必填**:
```text
// =============================================================================
//  🎉 [中文含义] ([参数的中文含义]，[参数的中文含义]，[参数的中文含义]，...)
//
//  🎨 代码用途：
//      [专业描述：精准的编程术语，描述这段代码的技术目，但要易懂]
//
//  💡 易懂解释：
//      [高中生能懂，正面可爱语气，不使用比喻]
//  
//  ⚠️ 警告：
//      [风险类型]: [具体后果与解决方案]
//      (例如：死锁隐患、内存溢出、数据一致性等。若无特殊风险，写“无特殊风险”)
//  
//  ⚙️ 触发源 (Trigger Source)：
//      [文件/模块] -> [UI交互/事件] -> [函数调用链]
//      (例如：通过 admin_panel.js 后台管理系统的 “强制结算” 按钮 handle_click(参数名,参数名,) -> Admin_Force_Settle(参数名,参数名,) 触发)
// =============================================================================
```

**C. 📍 视觉状态信标 (Visual State Beacons)**
*   **定义**: 优先选用正面、可爱的 Emoji作为**视觉信标**，将代码逻辑映射为人类可读的语义块。
*   **覆盖率**: **100%** (除纯括号外)。每一行代码必须有信标。
*   **内容**: **状态/结果导向 (State/Result Oriented)**。
    *   侧重描述代码执行后的 **“状态变化”** 或 **“业务结果”**。
    *   **严禁**使用逗号、长句或“初始化为...”等废话。
    *   **风格**: 词汇偏名词化，简洁有力，像仪表盘的状态灯。
*   **语法适配**: 自动识别 `.py` (#), `.js` (//), `.bat` (REM), `.html` (<!-- -->)。

**示例**:
```python
def calculate_score(points):
    # ... (此处必须有完整的五段式备注) ...
    current_score = 0  # 🥚 基础分归零
    if points > 10:    # ⚖️ 高分阈值判定
        current_score = points * 2  # 🚀 双倍奖励生效
    return current_score # 📤 最终结果交付
```
